function loadInsight(e,t){const n=document.querySelector(".searchbox"),s=n.querySelector(".searchbox-input"),r=n.querySelector(".searchbox-body");function c(e,t,n){if(!Array.isArray(t)||!t.length||!e)return n?e.slice(0,n):e;const s=e.toLowerCase(),r=t.map((e=>{const t=s.indexOf(e.toLowerCase());return e&&-1!==t?[t,t+e.length]:null})).filter((e=>null!==e)).sort(((e,t)=>e[0]-t[0]||e[1]-t[1]));if(!r.length)return e;let c="",o=0;const a=function(e){let t;const n=[];return e.forEach((e=>{!t||e[0]>t[1]?n.push(t=e):e[1]>t[1]&&(t[1]=e[1])})),n}(r),i=[a[0][0],a[a.length-1][1]];n&&n<i[1]&&(o=i[0]);for(let t=0;t<a.length;t++){const s=a[t];if(c+=e.slice(o,Math.min(s[0],i[0]+n)),n&&s[0]>=i[0]+n)break;c+="<em>"+e.slice(s[0],s[1])+"</em>",o=s[1],t===a.length-1&&(c+=n?e.slice(s[1],Math.min(e.length,i[0]+n+1)):e.slice(s[1]))}return c}function o(e,n,s,r,c){n=null!=n&&""!==n?n:t.untitled;const o=[];switch(e){case"file":o.push('<svg xmlns="http://www.w3.org/2000/svg" height="16" width="12" viewBox="0 0 384 512">','<path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"/>',"</svg>");break;case"folder":o.push('<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512">','<path d="M464 128H272l-64-64H48C21.5 64 0 85.5 0 112v288c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V176c0-26.5-21.5-48-48-48z" />',"</svg>");break;case"tag":o.push('<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512">','<path d="M0 252.1V48C0 21.5 21.5 0 48 0h204.1a48 48 0 0 1 33.9 14.1l211.9 211.9c18.7 18.7 18.7 49.1 0 67.9L293.8 497.9c-18.7 18.7-49.1 18.7-67.9 0L14.1 286.1A48 48 0 0 1 0 252.1zM112 64c-26.5 0-48 21.5-48 48s21.5 48 48 48 48-21.5 48-48-21.5-48-48-48z"/>',"</svg>")}return[`<a class="searchbox-result-item" href="${c}">`,""+(o.length>0?'<span class="searchbox-result-icon">'+o.join("")+"</span>":""),'<span class="searchbox-result-content">',`<span class="searchbox-result-title">${n}</span>`,""+(r?'<span class="searchbox-result-preview">'+r+"</span>":""),"</span>","</a>"].join("")}function a(e,t,n){if(0===n.length)return null;switch(t){case"POSTS":case"PAGES":return n.map((t=>o("file",c(t.title,e),0,c(t.text,e,100),t.link)));case"CATEGORIES":case"TAGS":return n.map((n=>{const s=c(n.name,e);c(n.slug,e);return o("CATEGORIES"===t?"folder":"tag",s,0,null,n.link)}))}return null}function i(e){return e.split(" ").filter((e=>!!e)).map((e=>e.toLowerCase()))}function l(e,t,n){const s=i(e);return s.filter((e=>n.filter((n=>!!Object.prototype.hasOwnProperty.call(t,n)&&t[n].toLowerCase().indexOf(e)>-1)).length>0)).length===s.length}function u(e,t,n,s){let r=0;return i(e).forEach((e=>{const c=new RegExp(e,"img");n.forEach(((e,n)=>{if(Object.prototype.hasOwnProperty.call(t,e)){const o=t[e].match(c);r+=o?o.length*s[n]:0}}))})),r}function h(e,t){const n=function(e){return{post:function(t){return u(e,t,["title","text"],[3,1])},page:function(t){return u(e,t,["title","text"],[3,1])},category:function(t){return u(e,t,["name","slug"],[1,1])},tag:function(t){return u(e,t,["name","slug"],[1,1])}}}(t),s=function(e){return{post:function(t){return l(e,t,["title","text"])},page:function(t){return l(e,t,["title","text"])},category:function(t){return l(e,t,["name","slug"])},tag:function(t){return l(e,t,["name","slug"])}}}(t),r=e.posts,c=e.pages,o=e.tags,a=e.categories;return{posts:r.filter(s.post).sort(((e,t)=>n.post(t)-n.post(e))).slice(0,5),pages:c.filter(s.page).sort(((e,t)=>n.page(t)-n.page(e))).slice(0,5),categories:a.filter(s.category).sort(((e,t)=>n.category(t)-n.category(e))).slice(0,5),tags:o.filter(s.tag).sort(((e,t)=>n.tag(t)-n.tag(e))).slice(0,5)}}function g(e){const t=r.querySelectorAll(".searchbox-result-item");let n=-1;t.forEach(((e,t)=>{e.classList.contains("active")&&(n=t)})),n>-1&&t.item(n).classList.remove("active");const s=(t.length+n+e)%t.length;t.item(s).classList.add("active"),t.item(s).scrollIntoView(!1)}const p=new XMLHttpRequest;p.onreadystatechange=()=>{if(4!==p.readyState||200!==p.status)return;"#insight-search"===location.hash.trim()&&n.classList.add("show");const e=JSON.parse(p.responseText);s.addEventListener("input",(n=>{const s=n.target.value;!function(e,n){r.innerHTML="";const s=i(e);for(const e in n){const c=e.toUpperCase(),o=a(s,c,n[e]);if(null==o)continue;const i=document.createElement("section");i.classList.add("searchbox-result-section"),i.innerHTML=`<header>${t[c.toLowerCase()]}</header>${o.join("")}`,r.appendChild(i)}}(s,h(e,s))})),s.dispatchEvent(new InputEvent("input"))},p.open("GET",e.contentUrl,!0),p.send(null);let d=!1;document.querySelector(".navbar-main .search").addEventListener("click",(()=>{n.classList.add("show"),n.querySelector(".searchbox-input").focus()})),document.querySelectorAll(".searchbox-result-item").forEach((e=>{const t=e=>{location.href=e.getAttribute("href")};e.addEventListener("click",(()=>{t(e),d=!1})),e.addEventListener("touchend",(()=>{d&&(t(e),d=!1)}))})),document.querySelectorAll(".searchbox-close").forEach((e=>{const t=document.querySelectorAll(".navbar-main"),s=()=>{t.forEach((e=>{e.style.pointerEvents="none",setTimeout((()=>{e.style.pointerEvents="auto"}),400)})),n.classList.remove("show"),d=!1};e.addEventListener("click",(()=>{s()})),e.addEventListener("touchend",(()=>{d&&s()}))})),document.addEventListener("keydown",(e=>{if(n.classList.contains("show"))switch(e.code){case"Escape":n.classList.remove("show");break;case"ArrowUp":g(-1);break;case"ArrowDown":g(1);break;case"Enter":r.querySelectorAll(".searchbox-result-item.active").forEach((e=>{location.href=e.getAttribute("href")}))}})),document.addEventListener("touchstart",(()=>{d=!0})),document.addEventListener("touchmove",(()=>{d=!1}))}